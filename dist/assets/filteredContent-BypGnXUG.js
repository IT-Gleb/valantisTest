import{r,s as y,T,E as N,I as E,a as I,n as D,_ as R,b as F,j as e,M as k}from"./index-tAmM7JxE.js";import{u as x,l as S,F as M}from"./content-DgdU_g2P.js";import{E as L}from"./errorBox-WhFc81Ya.js";async function C(l,i,s,u,h=0,o=1e3){let n=y(l),c=0;try{s(!0),u(!1);const f=await fetch(T,n),j=await f.json();if(f.ok||(c=f.status,N(c)),f.ok){let d=Array.from(j.result);d.length<1&&(c=133,N(c)),d=S.uniq(d),d.length>E&&(d=d.slice(h*E,h*E+I)),n=y({action:"get_items",params:{ids:d}});const m=await fetch(T,n),g=await m.json();m.ok||(c=m.status,N(c)),m.ok&&i(g.result)}}catch(f){console.log(f),c!==133&&c!==401&&c!==403&&c!==404&&setTimeout(()=>{C(l,i,s,u,h)},o),s(!1),u(!0)}}async function B(l,i,s,u=1e3){const h=y(l);let o=-1;try{s(!0);const n=await fetch(T,h),c=await n.json();n.ok&&(i(c.result.length),s(!1)),n.ok||(i(-1),o=n.status,N(o))}catch(n){console.log(n),s(!1),o!==401&&o!==403&&o!==404&&setTimeout(()=>{B(l,i,s)},u)}}function O(){const l=x(t=>t.active),i=x(t=>t.filterMode),s=x(t=>t.filterBrand),u=x(t=>t.filterName),h=x(t=>t.filterPrice),o=x(t=>t.activePage),[n,c]=r.useState(0),[f,j]=r.useState(!1),[d,A]=r.useState(0),[m,g]=r.useState([]),[b,w]=r.useState(!1);return r.useEffect(()=>{let t={action:"filter"};switch(i){case 0:t.params={brand:s===D?null:s};break;case 1:t.params={product:u};break;case 2:t.params={price:h};break}function a(v){A(v),c(Math.ceil(v/E)),j(!1)}function _(v){j(v)}B(t,a,_)},[l]),r.useEffect(()=>{let t={action:"filter"};switch(i){case 0:t.params={brand:s===D?null:s};break;case 1:t.params={product:u};break;case 2:t.params={price:h};break}const a=P=>{j(P)},_=P=>{if(Array.isArray(P)){w(!1);let p=Array.from(P);p.length>1&&(p=S.uniqBy(p,"id")),p.length>E&&(p=p.slice(0,E)),p=S.orderBy(p,["price"],["asc"]),g(p)}};function v(P){w(P)}C(t,_,a,v,o)},[o]),{allRec:d,PagesCount:n,isLoad:f,data:m,errorData:b}}const V=r.lazy(()=>R(()=>import("./content-DgdU_g2P.js").then(l=>l.v),__vite__mapDeps([0,1,2,3]))),q=r.lazy(()=>R(()=>import("./Pages-LDzugIoC.js"),__vite__mapDeps([4,1,2])));function H(){const{allRec:l,PagesCount:i,data:s,errorData:u}=O(),h=x(a=>a.setActive),o=x(a=>a.setActivePage),[n,c]=r.useState(0),f=x(a=>a.filterMode),j=x(a=>a.currentValue),[d,A]=r.useState(""),[m,g]=r.useState(!1),b=r.useRef(-1),w=()=>{h(!1)},t=(a,_)=>{a.preventDefault(),o(_),c(_)};if(r.useEffect(()=>(g(!0),b.current=setTimeout(()=>{m||s.length<1?(g(!0),clearTimeout(b.current),b.current=setTimeout(()=>{g(!1),clearTimeout(b.current)},F)):g(!1)},F),()=>{clearTimeout(b.current)}),[n]),r.useEffect(()=>{let a="";switch(f){case 0:a="По бренду";break;case 1:a="По наименованию";break;case 2:a="По цене";break}A(a)},[f]),m)return e.jsx("div",{className:"w-[100%] mt-[20%]",children:e.jsx(k,{})});if(!m&&s.length<1||u)return e.jsxs("section",{className:"w-[100%",children:[e.jsx("div",{className:"flex items-center justify-end p-2 mb-12",children:e.jsx(M,{paramTitle:"Отменить фильтрацию",setShowFilter:w})}),e.jsx(L,{children:e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"w-[100%] p-2 border-b-2 border-b-white/30 overflow-hidden",children:"Внимание!!!"}),e.jsxs("div",{className:"text-[0.9rem]/[1rem] font-normal text-center my-8 overflow-hidden",children:[e.jsx("p",{children:"По Вашему запросу - нечего не найдено."}),e.jsx("p",{children:"Попробуйте, отменить фильтрацию. Изменить запрос!!!"}),e.jsx("p",{className:"mt-4 font-bold",children:":-("})]})]})})]});if(!m&&!u)return e.jsxs("section",{className:"w-[100%] p-0 m-0",children:[e.jsx("div",{className:"flex items-center justify-end p-2",children:e.jsx(M,{paramTitle:"Отменить фильтрацию",setShowFilter:w})}),e.jsxs("div",{className:"bg-slate-100 text-slate-500 p-4 text-[0.85rem]/[1rem] font-semibold flex flex-col gap-y-2",children:[e.jsxs("h3",{children:["Записи отфильтрованы="," ",e.jsx("span",{className:"text-blue-700 uppercase",children:d})]}),e.jsxs("h4",{children:["Значение="," ",e.jsx("span",{className:"text-[1.2rem]/[1.2rem] text-blue-600",children:j})]}),e.jsxs("h4",{children:["Всего найдено="," ",e.jsx("span",{className:"text-blue-600 text-[1.1rem]/[1.2rem] font-medium",children:l})," ","наименований"]})]}),e.jsx(r.Suspense,{fallback:e.jsx(k,{}),children:s.length>0&&l>0&&e.jsx(V,{paramItems:s,paramMaxRec:i,paramPage:n})}),e.jsx(r.Suspense,{fallback:e.jsx(k,{}),children:i>1&&e.jsx("div",{className:"w-[100%] border-t-2 border-t-slate-400/40 mt-4",children:e.jsx(q,{paramPageCount:i,paramCurrPage:n,paramChangePage:t})})})]})}export{H as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/content-DgdU_g2P.js","assets/index-tAmM7JxE.js","assets/index-zJudwzqX.css","assets/errorBox-WhFc81Ya.js","assets/Pages-LDzugIoC.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
